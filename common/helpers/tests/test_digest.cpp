#include <gtest/gtest.h>
#include <cstdint>

#include "common/helpers/digest.h"

namespace {

TEST(CurlTest, testDigest) {
  const std::string HASH =
      "EBCGQXTGVGYPVKWI9AHYCVNXBLDJOHVKIMPOCJJE99PUOZJKNTLDLVBLZLXABOCKLQVVDACL"
      "9VHWST999";

  const std::string TX =
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999999999999999999999999999999999999999999999999"
      "999999999999999999999999999SAYHELLOTOECHOCATCHERECHOCATCHINGSINCETWENTYS"
      "EVENTEENONTHEIOTATANGLE9999999999999999999999999999999999999999VD9999999"
      "999999999999999999YLNREYD99999999999999999999JURSJVFIECKJYEHPATCXADQGHAB"
      "KOOEZCRUHLIDHPNPIGRCXBFBWVISWCF9ODWQKLXBKY9FACCKVXRAGZKKHGI9DTHVU9DZLKEE"
      "KMMYMZTAAUCLQXXJENMEP9CRPKOUTQENQMHFCDSQI9KJOOESOMKXISI9XLRA999AMVFWKSKT"
      "BISQSVEWBKKVKBWCTBEV9PVWETXPXII99HHXMELOJKZIC9IUGIAUKBMPKTPHQILDLRDDA999"
      "999999999999999999999999999999999999999999999999999999ZM99999999IA999999"
      "999999999";

  char* out = iota_digest(TX.c_str());

  EXPECT_EQ(out, HASH);

  free(out);
}

}  // namespace
